{{template "layout.tmpl" .}}

{{define "content"}}
<main class="container">
    <article>
        <p>{{.Post.Content}}</p>
        <p><small>Posted by <a href="/u/{{.Post.User.Username}}">{{.Post.User.Username}}</a> at <a href="/p/{{.Post.ID}}"><time datetime='{{.Post.CreatedAt.Format "2006-01-02T15:04:05Z07:00"}}'>{{.Post.CreatedAt.Format "2006-01-02 15:04:05"}}</time></a></small></p>
    </article>

    <h2>Comments</h2>

    {{if .LoggedIn}}
    <form action="/posts/{{.Post.ID}}/comments" method="post">
        <div>
            <textarea name="content" placeholder="Say something..." aria-label="Content" required></textarea>
        </div>

        {{with .Error}}
        <div class="error">
            <p>{{.}}</p>
        </div>
        {{end}}

        <button>Comment</button>
    </form>

    <br>
    {{end}}

    {{if not .Comments.Items}}
        <p>No comments yet</p>
    {{else}}
        <div role="feed">
            {{range .Comments.Items}}
                <article>
                    <p>{{.Content | linkify}}</p>
                    <p><small>Commented on by <a href="/u/{{.User.Username}}">{{.User.Username}}</a> at <time datetime='{{.CreatedAt.Format "2006-01-02T15:04:05Z07:00"}}'>{{.CreatedAt.Format "2006-01-02 15:04:05"}}</time></small></p>
                </article>
            {{end}}
        </div>
    {{end}}
</main>
{{end}}